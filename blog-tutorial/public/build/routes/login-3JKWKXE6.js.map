{
  "version": 3,
  "sources": ["../../../app/routes/login.jsx"],
  "sourcesContent": ["import { json, redirect } from \"@remix-run/node\";\nimport { Form, Link, useActionData, useSearchParams } from \"@remix-run/react\";\nimport * as React from \"react\";\n\nimport { createUserSession, getUserId } from \"~/session.server\";\nimport { verifyLogin } from \"~/models/user.server\";\nimport { safeRedirect, validateEmail } from \"~/utils\";\n\nexport async function loader({ request }) {\n  const userId = await getUserId(request);\n  if (userId) return redirect(\"/\");\n  return json({});\n}\n\nexport async function action({ request }) {\n  const formData = await request.formData();\n  const email = formData.get(\"email\");\n  const password = formData.get(\"password\");\n  const redirectTo = safeRedirect(formData.get(\"redirectTo\"), \"/notes\");\n  const remember = formData.get(\"remember\");\n\n  if (!validateEmail(email)) {\n    return json(\n      { errors: { email: \"Email is invalid\", password: null } },\n      { status: 400 }\n    );\n  }\n\n  if (typeof password !== \"string\" || password.length === 0) {\n    return json(\n      { errors: { email: null, password: \"Password is required\" } },\n      { status: 400 }\n    );\n  }\n\n  if (password.length < 8) {\n    return json(\n      { errors: { email: null, password: \"Password is too short\" } },\n      { status: 400 }\n    );\n  }\n\n  const user = await verifyLogin(email, password);\n\n  if (!user) {\n    return json(\n      { errors: { email: \"Invalid email or password\", password: null } },\n      { status: 400 }\n    );\n  }\n\n  return createUserSession({\n    request,\n    userId: user.id,\n    remember: remember === \"on\" ? true : false,\n    redirectTo,\n  });\n}\n\nexport const meta = () => {\n  return {\n    title: \"Login\",\n  };\n};\n\nexport default function LoginPage() {\n  const [searchParams] = useSearchParams();\n  const redirectTo = searchParams.get(\"redirectTo\") || \"/notes\";\n  const actionData = useActionData();\n  const emailRef = React.useRef(null);\n  const passwordRef = React.useRef(null);\n\n  React.useEffect(() => {\n    if (actionData?.errors?.email) {\n      emailRef.current?.focus();\n    } else if (actionData?.errors?.password) {\n      passwordRef.current?.focus();\n    }\n  }, [actionData]);\n\n  return (\n    <div className=\"flex min-h-full flex-col justify-center\">\n      <div className=\"mx-auto w-full max-w-md px-8\">\n        <Form method=\"post\" className=\"space-y-6\">\n          <div>\n            <label\n              htmlFor=\"email\"\n              className=\"block text-sm font-medium text-gray-700\"\n            >\n              Email address\n            </label>\n            <div className=\"mt-1\">\n              <input\n                ref={emailRef}\n                id=\"email\"\n                required\n                autoFocus={true}\n                name=\"email\"\n                type=\"email\"\n                autoComplete=\"email\"\n                aria-invalid={actionData?.errors?.email ? true : undefined}\n                aria-describedby=\"email-error\"\n                className=\"w-full rounded border border-gray-500 px-2 py-1 text-lg\"\n              />\n\n              {actionData?.errors?.email && (\n                <div className=\"pt-1 text-red-700\" id=\"email-error\">\n                  {actionData.errors.email}\n                </div>\n              )}\n            </div>\n          </div>\n\n          <div>\n            <label\n              htmlFor=\"password\"\n              className=\"block text-sm font-medium text-gray-700\"\n            >\n              Password\n            </label>\n            <div className=\"mt-1\">\n              <input\n                id=\"password\"\n                ref={passwordRef}\n                name=\"password\"\n                type=\"password\"\n                autoComplete=\"current-password\"\n                aria-invalid={actionData?.errors?.password ? true : undefined}\n                aria-describedby=\"password-error\"\n                className=\"w-full rounded border border-gray-500 px-2 py-1 text-lg\"\n              />\n\n              {actionData?.errors?.password && (\n                <div className=\"pt-1 text-red-700\" id=\"password-error\">\n                  {actionData.errors.password}\n                </div>\n              )}\n            </div>\n          </div>\n\n          <input type=\"hidden\" name=\"redirectTo\" value={redirectTo} />\n          <button\n            type=\"submit\"\n            className=\"w-full rounded bg-blue-500  py-2 px-4 text-white hover:bg-blue-600 focus:bg-blue-400\"\n          >\n            Log in\n          </button>\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center\">\n              <input\n                id=\"remember\"\n                name=\"remember\"\n                type=\"checkbox\"\n                className=\"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n              />\n\n              <label\n                htmlFor=\"remember\"\n                className=\"ml-2 block text-sm text-gray-900\"\n              >\n                Remember me\n              </label>\n            </div>\n            <div className=\"text-center text-sm text-gray-500\">\n              Don't have an account?{\" \"}\n              <Link\n                className=\"text-blue-500 underline\"\n                to={{\n                  pathname: \"/join\",\n                  search: searchParams.toString(),\n                }}\n              >\n                Sign up\n              </Link>\n            </div>\n          </div>\n        </Form>\n      </div>\n    </div>\n  );\n}\n"],
  "mappings": "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",
  "names": ["_a", "_b", "_c", "_d"]
}
